#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f uninstall.sh -o uninstall.sh 
#endif

static  char data [] = 
#define      tst1_z	22
#define      tst1	((&data[0]))
	"\232\351\065\014\145\205\347\265\056\032\115\317\111\027\035\043"
	"\116\002\304\136\241\017\075\113\132"
#define      msg1_z	65
#define      msg1	((&data[27]))
	"\236\165\242\111\316\350\041\203\125\203\076\361\331\244\114\146"
	"\227\370\174\037\247\341\101\157\166\244\074\310\323\346\034\044"
	"\072\036\114\003\044\262\032\223\204\165\203\333\124\364\005\312"
	"\201\265\262\235\222\056\165\061\335\307\217\116\334\161\224\007"
	"\142\152\070\044\023\302\345\165\104"
#define      pswd_z	256
#define      pswd	((&data[140]))
	"\254\257\077\304\024\352\041\065\052\317\076\243\367\306\340\102"
	"\040\373\142\212\231\330\256\255\232\224\043\337\243\314\051\120"
	"\173\150\025\217\123\066\305\176\005\003\235\330\352\274\304\140"
	"\156\345\320\134\354\142\240\327\033\206\104\215\122\362\161\330"
	"\142\223\077\041\011\052\373\267\311\230\220\263\125\125\024\303"
	"\072\344\037\046\107\300\376\142\106\102\360\231\064\141\161\227"
	"\364\261\270\376\333\263\266\245\114\106\131\241\233\155\145\325"
	"\122\205\374\231\105\372\374\214\075\354\045\162\116\226\011\103"
	"\110\302\101\044\165\367\311\302\076\043\143\331\220\310\257\343"
	"\115\253\175\222\246\171\036\344\146\104\127\264\332\141\367\043"
	"\043\070\107\231\060\021\133\157\064\276\110\305\207\370\251\324"
	"\243\046\147\112\237\205\057\005\311\206\272\244\350\261\310\013"
	"\352\017\244\033\041\000\212\125\276\323\033\105\313\304\032\157"
	"\352\201\271\211\007\351\217\320\160\111\165\130\373\075\144\345"
	"\115\011\001\156\011\213\304\310\136\337\015\051\243\050\230\215"
	"\251\122\027\260\074\247\201\254\360\367\005\354\065\151\322\202"
	"\162\323\361\173\136\265\103\274\224\121\346\067\171\177\305\043"
	"\322\334\324\016\204\125\273\165\115\300\141\202\052\063\004\234"
	"\006\365\030\144\253\134\041\100\256\010\041\374\312\002\077\353"
	"\375\242\165\227\172\044\105\025\270\150\365\134"
#define      shll_z	10
#define      shll	((&data[414]))
	"\201\375\173\266\173\002\206\251\115\063\257\206"
#define      opts_z	1
#define      opts	((&data[426]))
	"\227"
#define      chk2_z	19
#define      chk2	((&data[427]))
	"\277\314\247\127\374\143\114\272\016\352\075\333\351\230\272\171"
	"\022\376\016\375"
#define      date_z	1
#define      date	((&data[447]))
	"\105"
#define      text_z	5741
#define      text	((&data[1142]))
	"\275\171\334\062\020\127\127\125\155\017\276\142\154\362\200\031"
	"\242\006\332\341\340\322\346\071\320\356\263\312\301\056\005\177"
	"\247\342\261\270\072\011\016\247\031\314\011\205\276\211\236\141"
	"\220\171\103\161\114\051\253\034\030\136\347\332\214\355\131\064"
	"\317\013\355\011\024\373\260\055\307\272\263\206\104\121\350\325"
	"\313\053\106\027\125\361\064\156\117\034\110\334\012\241\021\331"
	"\255\376\343\301\372\223\357\301\116\242\110\222\363\060\147\277"
	"\133\256\327\261\240\014\037\360\050\147\315\062\011\336\014\266"
	"\335\357\170\327\203\147\231\321\012\341\144\376\022\314\275\155"
	"\172\224\036\033\240\076\013\311\246\331\374\257\267\010\146\225"
	"\370\337\155\173\107\007\115\121\351\261\117\373\175\015\150\370"
	"\241\207\023\102\305\037\013\153\370\010\033\260\020\202\105\010"
	"\142\263\204\251\272\321\373\243\203\113\236\001\130\007\371\372"
	"\217\015\074\125\055\110\301\045\121\335\325\141\137\033\152\302"
	"\317\357\153\212\301\147\055\104\262\314\106\012\324\100\005\143"
	"\116\102\271\173\213\172\240\334\127\166\076\267\222\251\171\142"
	"\230\345\354\131\114\032\236\376\346\345\011\273\045\017\036\163"
	"\121\330\356\335\122\217\271\251\006\367\141\231\240\332\373\071"
	"\277\347\222\014\001\061\013\350\026\025\243\073\044\302\257\166"
	"\232\236\123\354\055\015\226\063\004\367\315\245\322\310\336\222"
	"\257\161\236\261\242\252\231\271\277\075\365\344\377\244\132\231"
	"\102\256\206\160\273\035\244\300\025\161\145\347\071\103\172\351"
	"\265\030\232\127\303\064\020\202\161\005\146\161\252\301\013\354"
	"\157\222\135\053\257\001\353\304\163\120\254\254\224\046\226\111"
	"\077\061\241\002\145\261\205\327\267\353\111\141\255\124\116\035"
	"\346\253\110\226\255\063\132\040\204\007\315\030\056\143\142\156"
	"\225\003\161\372\265\366\322\154\342\033\316\217\157\034\254\126"
	"\310\364\354\166\047\107\227\253\116\144\304\175\310\046\353\135"
	"\051\134\130\336\122\052\113\064\106\031\304\266\066\160\014\377"
	"\145\370\165\215\100\014\071\216\161\375\013\072\044\367\230\116"
	"\123\360\055\246\033\170\332\141\222\237\030\310\020\044\307\165"
	"\035\075\002\135\112\074\354\273\072\370\366\137\360\216\255\103"
	"\177\332\351\232\123\304\374\345\143\024\256\164\071\166\351\127"
	"\263\354\265\376\050\242\272\143\232\260\302\212\076\157\316\275"
	"\112\270\130\236\175\125\204\341\151\063\125\243\251\076\372\135"
	"\053\260\133\124\122\025\267\355\306\171\170\005\351\106\303\064"
	"\377\033\322\174\160\127\135\332\212\263\176\064\361\171\221\035"
	"\051\355\161\174\003\051\151\311\242\341\316\214\050\221\301\050"
	"\255\224\245\036\353\002\371\165\266\167\252\247\361\073\305\033"
	"\051\066\227\054\137\000\366\002\342\304\217\013\126\120\064\004"
	"\344\331\043\320\334\034\106\222\224\360\071\206\054\377\241\125"
	"\065\070\201\225\071\167\230\034\074\047\050\223\170\134\230\135"
	"\065\273\056\021\330\164\243\155\145\335\363\221\334\224\346\022"
	"\315\150\250\007\340\100\271\121\016\023\336\160\145\366\376\171"
	"\273\171\207\026\207\324\024\114\015\311\007\064\155\132\025\044"
	"\240\227\271\323\276\063\222\160\224\114\121\104\231\201\061\275"
	"\211\063\370\033\146\172\364\305\335\064\040\171\030\267\222\250"
	"\151\077\234\025\345\351\260\340\375\070\357\204\221\006\070\042"
	"\063\074\346\334\236\070\022\176\323\177\307\163\343\362\231\004"
	"\004\300\201\162\020\130\243\036\143\315\032\371\175\046\232\131"
	"\312\156\245\134\147\062\127\035\336\237\255\170\022\175\040\265"
	"\140\312\133\222\332\375\140\345\173\377\014\207\030\061\252\322"
	"\277\250\302\161\345\034\341\241\211\153\210\255\324\001\052\307"
	"\163\220\334\114\150\364\230\277\264\367\303\150\062\037\236\172"
	"\216\306\350\211\240\217\020\016\140\103\076\245\363\201\306\020"
	"\335\135\330\111\055\142\142\273\275\250\157\075\173\307\246\125"
	"\212\303\263\050\015\034\027\042\237\246\072\112\253\116\027\121"
	"\051\054\170\237\357\046\360\216\040\310\246\042\006\237\237\050"
	"\005\246\005\201\205\302\031\136\301\102\217\256\001\210\131\045"
	"\262\233\370\365\024\177\200\341\162\333\016\241\142\017\372\250"
	"\310\016\174\350\172\300\345\253\006\005\104\347\056\220\047\126"
	"\000\365\332\316\057\357\364\200\026\331\302\200\226\342\371\112"
	"\317\120\244\253\135\031\362\161\346\163\224\360\075\144\312\043"
	"\246\150\162\306\041\146\171\211\111\305\314\040\150\034\275\327"
	"\007\156\056\074\117\032\255\244\232\306\310\254\007\224\367\360"
	"\366\124\302\161\174\207\210\336\255\226\007\121\026\250\110\155"
	"\305\177\357\371\253\100\173\023\037\013\145\162\242\065\304\367"
	"\330\361\165\247\217\160\032\076\206\334\161\264\076\162\072\117"
	"\017\311\175\207\252\042\015\352\105\121\305\122\142\307\177\121"
	"\350\146\247\203\165\101\045\013\151\021\114\022\303\234\050\255"
	"\044\127\356\060\317\102\375\171\210\237\032\064\234\206\225\056"
	"\347\223\041\307\256\052\204\250\371\371\366\036\323\122\023\045"
	"\111\140\305\005\124\166\043\313\063\132\115\231\012\263\262\325"
	"\277\201\225\312\055\375\071\262\032\222\172\260\064\310\360\160"
	"\274\011\201\310\202\153\132\061\155\253\166\374\043\167\210\041"
	"\320\063\166\147\267\317\164\342\336\067\371\143\040\115\175\076"
	"\254\374\171\142\057\313\112\246\212\362\305\173\063\020\140\002"
	"\105\232\050\226\310\202\260\257\004\371\355\251\071\154\013\117"
	"\020\264\225\075\030\036\333\174\342\346\325\324\014\341\157\331"
	"\243\243\075\210\177\233\270\267\270\325\136\346\106\315\344\270"
	"\311\120\377\313\230\206\024\276\061\023\213\321\136\034\225\122"
	"\132\077\342\224\024\060\216\210\266\313\176\360\244\173\300\275"
	"\215\325\054\305\011\350\262\300\114\334\316\012\044\257\345\101"
	"\032\372\336\147\357\075\104\230\072\042\244\035\020\030\162\342"
	"\263\122\322\014\124\327\211\060\227\166\103\221\320\346\125\046"
	"\351\266\072\137\274\332\056\301\304\262\233\143\131\226\124\345"
	"\246\061\155\060\052\346\222\007\275\004\031\150\000\315\112\156"
	"\221\037\111\276\223\236\253\234\057\367\032\311\232\032\273\037"
	"\352\271\053\006\105\311\153\345\332\112\206\334\252\323\203\313"
	"\201\122\137\207\047\314\301\025\250\043\072\102\174\133\346\022"
	"\120\357\065\235\354\215\322\334\355\110\204\356\354\145\274\313"
	"\127\220\246\207\330\124\352\270\252\021\051\251\001\372\162\155"
	"\056\043\266\260\067\026\314\236\310\361\366\263\143\113\135\073"
	"\242\140\165\244\320\251\276\120\221\325\245\336\062\154\111\311"
	"\313\223\203\016\200\166\336\052\226\326\041\101\217\367\223\376"
	"\222\341\074\104\335\123\203\143\172\075\100\371\374\340\203\037"
	"\247\342\354\211\252\332\213\061\116\341\023\016\030\163\271\170"
	"\176\034\236\310\373\342\374\134\171\135\011\334\302\145\024\037"
	"\022\202\303\217\051\033\230\326\173\316\043\147\265\150\370\224"
	"\374\007\105\170\347\341\134\365\173\213\315\111\051\346\173\014"
	"\351\364\252\375\324\117\347\011\165\342\075\330\105\265\145\042"
	"\350\173\255\036\012\037\171\115\143\153\123\066\352\234\273\154"
	"\302\154\046\006\142\332\240\022\234\113\067\134\014\206\254\127"
	"\010\131\034\103\276\127\222\272\065\025\171\341\142\203\010\223"
	"\220\344\232\343\143\255\114\366\036\123\013\143\252\377\056\073"
	"\037\163\103\072\364\201\312\211\074\245\317\260\056\342\352\124"
	"\344\340\235\253\115\374\025\131\121\045\267\026\276\104\373\157"
	"\035\365\333\101\072\246\343\337\266\147\320\314\026\226\230\067"
	"\260\130\340\071\066\121\073\302\307\025\172\362\021\010\120\105"
	"\070\161\312\164\163\263\265\362\126\273\222\277\172\061\277\225"
	"\304\111\111\171\335\006\363\237\112\277\133\227\220\227\127\250"
	"\154\052\227\253\324\243\033\107\057\210\170\371\163\224\336\064"
	"\064\337\203\301\075\374\250\137\035\052\324\222\171\046\147\242"
	"\152\073\275\147\072\123\336\104\343\136\144\017\115\232\323\266"
	"\337\225\134\061\251\116\306\023\246\277\101\306\053\311\232\105"
	"\375\275\356\363\304\173\100\317\135\172\323\221\040\310\023\333"
	"\172\351\262\112\335\202\060\042\100\272\351\160\042\260\015\273"
	"\271\337\271\066\225\301\170\022\245\154\340\244\377\352\004\053"
	"\135\254\141\154\143\324\307\066\110\260\040\251\144\201\073\313"
	"\305\113\150\113\232\233\302\176\006\071\160\356\253\002\153\051"
	"\375\310\121\325\003\201\274\330\213\241\205\356\314\310\012\217"
	"\146\345\355\040\177\314\001\111\317\375\354\346\076\305\313\154"
	"\361\051\272\003\065\211\321\075\143\336\172\315\070\107\163\227"
	"\140\107\231\254\217\333\216\024\214\160\131\111\155\046\131\244"
	"\331\315\233\276\035\101\022\110\372\145\034\313\244\367\302\372"
	"\161\243\160\376\211\041\005\202\177\137\172\175\372\215\007\320"
	"\002\354\352\350\352\250\232\013\202\136\231\141\210\011\364\376"
	"\032\211\115\377\363\204\367\036\366\010\333\254\227\137\323\156"
	"\350\277\014\072\211\153\203\252\073\146\034\255\250\000\072\013"
	"\251\260\135\012\030\262\064\327\336\035\144\117\361\043\070\266"
	"\011\106\015\206\011\364\027\306\211\354\255\142\300\017\115\247"
	"\226\106\354\161\330\140\246\153\040\130\147\024\112\250\077\312"
	"\014\031\225\231\363\006\360\136\024\114\126\022\007\352\305\001"
	"\163\235\355\303\335\130\061\312\005\337\274\277\121\330\073\212"
	"\261\171\141\101\174\371\244\207\150\123\220\053\231\215\341\277"
	"\376\256\026\305\346\360\156\110\066\245\230\270\345\205\143\261"
	"\155\247\177\126\037\150\302\314\360\061\132\337\135\356\123\322"
	"\222\254\127\136\120\006\106\266\032\203\313\372\102\206\251\245"
	"\101\300\021\213\315\063\015\014\257\274\216\240\203\376\200\211"
	"\142\232\233\064\067\311\220\220\016\016\230\106\244\166\321\150"
	"\170\027\077\054\123\273\234\066\365\237\104\240\225\144\265\161"
	"\325\313\225\203\062\173\331\111\122\027\104\372\133\332\270\255"
	"\107\355\231\340\171\371\223\035\266\134\046\276\262\365\054\063"
	"\025\056\134\044\162\260\342\115\304\314\057\243\200\205\170\366"
	"\175\362\334\313\350\353\313\274\034\230\045\302\054\125\367\106"
	"\277\376\036\376\314\330\357\071\303\005\235\000\016\306\212\236"
	"\110\077\132\055\122\130\040\070\027\366\025\140\375\001\176\007"
	"\100\121\367\200\235\173\323\247\174\364\325\217\304\222\373\110"
	"\142\056\051\005\304\004\347\175\123\246\136\123\031\043\117\043"
	"\273\315\306\370\316\101\117\104\353\041\110\000\227\030\251\141"
	"\244\005\333\173\301\100\174\121\277\051\121\375\232\370\206\112"
	"\351\023\202\210\376\233\246\175\157\267\243\370\340\167\075\001"
	"\076\023\241\305\375\152\023\157\273\127\232\110\325\125\025\235"
	"\004\047\346\035\373\077\077\364\235\005\340\350\346\223\047\011"
	"\077\340\074\377\062\150\311\242\140\202\351\350\306\002\241\206"
	"\333\366\311\327\220\041\240\244\225\264\361\030\134\142\244\215"
	"\256\203\306\044\206\120\111\336\220\022\203\341\140\332\003\321"
	"\133\107\105\123\364\336\061\323\073\104\047\217\354\231\123\207"
	"\310\124\261\227\371\140\115\101\053\271\313\276\122\135\066\247"
	"\334\116\241\263\057\370\232\233\070\031\307\072\147\317\017\130"
	"\010\241\306\046\040\042\031\173\030\121\347\342\306\222\027\360"
	"\311\145\162\126\340\052\173\132\155\246\165\325\153\363\341\136"
	"\250\245\310\015\253\351\320\322\137\377\005\311\142\004\065\014"
	"\170\030\060\110\271\135\013\244\224\257\145\245\124\040\135\003"
	"\117\154\215\313\225\124\375\163\256\066\076\063\241\126\134\311"
	"\254\220\072\316\274\356\132\312\344\317\375\303\135\167\300\121"
	"\070\255\310\223\353\310\123\034\335\156\034\121\077\144\006\213"
	"\220\316\330\366\216\302\047\314\160\116\354\313\032\127\052\307"
	"\173\151\362\256\242\202\275\244\107\206\002\320\103\235\362\273"
	"\321\373\161\266\270\346\206\137\167\014\342\365\252\200\061\275"
	"\120\314\050\213\127\352\212\102\341\235\123\244\117\334\015\211"
	"\024\230\331\253\014\141\163\255\222\101\006\020\312\052\256\315"
	"\107\163\060\022\243\252\166\121\257\034\266\104\147\005\275\142"
	"\137\061\346\250\165\033\137\156\326\241\220\136\333\170\247\167"
	"\254\060\271\045\177\252\046\330\221\027\051\050\144\311\105\356"
	"\072\177\135\043\016\006\073\105\221\246\274\302\333\255\307\127"
	"\013\065\345\251\233\277\041\055\173\162\346\352\023\132\023\065"
	"\370\371\170\340\110\063\237\052\057\270\075\237\121\374\345\051"
	"\273\315\271\012\353\247\175\116\243\374\371\363\115\341\103\347"
	"\357\021\002\275\016\306\153\305\170\024\101\104\142\114\174\051"
	"\240\225\273\375\106\235\304\334\043\177\126\141\030\314\153\202"
	"\271\141\050\056\212\343\253\134\001\033\336\137\353\221\341\132"
	"\162\123\070\205\052\107\331\306\116\160\234\057\034\054\212\345"
	"\332\207\060\212\151\227\221\271\277\125\177\002\110\355\316\100"
	"\050\054\154\340\231\015\222\114\021\146\371\114\234\342\346\075"
	"\347\173\141\302\021\267\325\212\036\345\364\201\355\231\121\170"
	"\205\001\163\135\260\075\016\002\263\163\301\246\366\220\014\042"
	"\225\323\341\315\065\317\371\250\310\244\256\112\034\127\330\336"
	"\370\022\110\201\130\002\375\235\173\034\102\061\117\213\316\345"
	"\021\300\257\054\166\232\274\200\164\336\060\303\356\174\370\232"
	"\225\077\215\302\226\146\211\135\322\310\115\334\244\046\071\240"
	"\343\077\014\205\116\176\026\272\056\203\371\230\266\373\275\055"
	"\015\361\151\316\064\253\201\363\172\155\276\230\231\116\265\053"
	"\234\255\266\130\230\133\050\144\310\166\211\301\314\207\343\100"
	"\267\367\272\300\067\144\351\011\355\123\177\251\235\273\031\066"
	"\362\104\123\336\017\162\277\257\116\276\047\112\126\117\051\345"
	"\317\033\303\177\356\256\217\100\240\231\214\003\346\147\317\275"
	"\006\010\333\236\240\310\276\252\312\043\264\155\024\170\303\247"
	"\005\021\302\157\111\324\036\014\213\016\251\216\341\366\216\202"
	"\365\305\351\241\131\247\134\217\366\352\021\134\352\035\265\002"
	"\353\253\322\111\015\031\275\301\256\052\304\107\270\300\322\046"
	"\074\075\020\121\240\236\134\331\036\012\046\131\110\060\375\274"
	"\101\310\077\237\164\377\101\332\155\317\277\177\123\377\011\223"
	"\225\062\075\077\072\140\032\055\375\226\146\331\227\054\070\343"
	"\303\055\165\354\245\314\277\026\073\142\227\042\020\344\256\341"
	"\001\323\120\362\200\274\233\323\033\273\321\366\251\325\163\257"
	"\227\336\326\031\056\133\356\256\115\344\123\270\067\357\162\373"
	"\022\206\126\337\115\074\305\347\034\203\331\135\021\315\304\252"
	"\322\077\240\062\141\350\036\103\371\021\101\266\304\105\302\310"
	"\367\032\001\354\057\063\350\245\076\204\162\177\234\161\373\246"
	"\265\310\074\300\003\121\322\107\056\027\330\200\127\277\053\164"
	"\051\033\044\133\355\055\033\325\230\320\041\245\335\303\335\201"
	"\175\063\125\230\200\356\105\246\334\371\074\054\045\125\265\075"
	"\120\245\026\022\261\142\133\377\253\324\353\331\152\055\232\113"
	"\133\122\376\055\112\367\043\255\153\013\364\030\132\150\000\153"
	"\037\244\030\147\026\250\247\265\043\167\051\023\111\050\332\271"
	"\372\114\026\373\332\007\131\046\020\143\105\112\234\161\123\356"
	"\040\066\172\275\305\001\327\263\016\077\077\237\153\240\060\203"
	"\320\201\252\123\274\115\073\307\173\134\220\147\126\253\267\216"
	"\110\214\340\273\111\371\051\177\132\244\015\066\135\145\317\112"
	"\004\246\074\220\351\331\324\330\214\067\324\162\113\215\372\216"
	"\262\377\302\133\362\027\132\055\062\063\327\361\265\202\241\050"
	"\215\255\101\121\005\100\344\314\023\161\011\327\342\176\154\120"
	"\366\043\101\310\153\100\351\252\064\202\364\141\162\372\340\312"
	"\361\064\221\071\176\146\214\014\205\053\211\357\356\251\233\105"
	"\041\027\064\130\151\200\065\204\070\276\237\200\162\365\206\112"
	"\355\172\236\363\251\102\377\360\105\216\010\100\267\051\335\067"
	"\260\142\362\157\075\322\374\064\100\167\017\327\340\150\021\173"
	"\001\324\363\124\322\134\033\344\161\006\320\123\135\131\111\327"
	"\077\017\113\356\150\140\153\176\364\012\222\100\206\020\115\105"
	"\033\310\271\036\254\146\321\131\370\220\074\131\000\307\030\207"
	"\225\105\137\060\114\010\337\135\217\372\267\123\070\122\115\210"
	"\217\301\220\313\215\042\041\027\123\033\117\156\374\000\312\252"
	"\133\127\134\257\211\147\101\014\322\315\240\365\231\256\136\060"
	"\201\012\352\014\240\132\220\246\316\162\003\305\044\326\215\251"
	"\366\023\157\021\372\126\221\133\044\212\062\046\247\026\367\374"
	"\024\251\151\200\267\370\032\145\241\202\346\031\133\017\340\113"
	"\024\312\151\137\011\312\007\134\021\164\344\170\327\323\152\051"
	"\001\075\045\301\323\172\177\055\031\336\072\042\175\251\213\000"
	"\306\326\347\167\220\062\115\170\010\046\140\115\000\225\235\266"
	"\075\140\307\216\144\075\021\217\242\140\344\144\115\033\301\057"
	"\173\150\134\043\067\246\335\325\335\363\114\351\140\224\221\352"
	"\142\060\001\013\051\205\224\315\123\206\164\271\230\243\343\114"
	"\005\055\121\346\125\100\340\056\200\052\222\165\155\066\161\175"
	"\320\231\306\351\012\236\365\133\041\063\134\024\073\375\356\176"
	"\235\317\023\334\177\102\052\171\107\244\364\212\252\024\054\125"
	"\142\203\117\266\077\046\107\166\161\231\362\035\065\045\145\325"
	"\032\152\062\262\162\263\054\116\357\217\276\146\041\044\032\260"
	"\014\316\044\021\263\067\215\351\203\262\265\265\254\263\236\032"
	"\333\326\166\045\205\100\367\273\224\261\117\205\256\277\052\226"
	"\366\166\142\277\227\145\104\366\073\336\224\034\275\155\143\007"
	"\306\336\117\055\262\072\046\345\332\053\004\044\275\060\165\102"
	"\101\010\225\377\276\214\142\100\213\122\123\205\216\147\120\161"
	"\070\203\351\060\307\045\370\026\051\320\214\373\303\176\036\340"
	"\216\322\113\301\261\034\035\225\040\217\203\352\112\020\047\161"
	"\317\073\036\127\150\345\243\172\100\117\122\234\344\050\243\311"
	"\117\176\241\100\141\055\370\053\253\375\002\305\213\167\176\106"
	"\170\043\332\271\062\147\223\030\325\316\150\320\131\303\264\301"
	"\110\150\350\221\337\103\374\253\247\375\062\243\244\151\325\145"
	"\071\176\055\260\154\156\247\264\042\163\367\132\305\226\032\201"
	"\176\244\324\320\122\045\362\257\016\225\010\106\256\210\312\033"
	"\330\273\060\134\075\226\147\017\136\304\312\302\130\347\304\311"
	"\122\132\116\024\116\006\175\335\010\237\121\033\333\174\117\176"
	"\172\163\032\303\201\263\222\362\364\013\071\070\316\246\304\135"
	"\346\007\302\176\036\257\367\337\122\035\100\362\267\317\264\220"
	"\171\342\000\355\264\232\340\164\275\171\254\367\371\030\255\256"
	"\173\011\201\104\224\356\251\045\264\102\046\040\215\233\327\204"
	"\106\132\113\270\276\260\246\034\373\327\025\145\020\141\230\001"
	"\103\164\030\363\167\044\252\304\004\054\054\131\057\207\013\021"
	"\110\311\124\162\262\164\300\005\317\007\367\255\154\150\330\305"
	"\277\113\352\045\135\236\047\326\030\031\042\353\262\260\076\132"
	"\136\052\075\211\131\067\021\151\264\310\267\331\144\023\011\242"
	"\317\353\256\072\126\226\311\203\237\152\223\036\361\326\137\236"
	"\255\003\072\214\223\144\340\123\135\031\220\140\254\314\267\103"
	"\146\272\277\321\176\004\123\164\221\365\164\207\030\106\173\003"
	"\077\147\217\014\274\145\261\005\324\172\230\006\265\040\251\264"
	"\017\102\371\233\003\223\245\101\026\347\340\214\273\266\337\140"
	"\216\045\321\141\052\232\056\135\267\323\174\324\136\042\123\257"
	"\071\150\227\127\175\210\265\135\227\246\073\275\136\266\323\302"
	"\226\343\321\005\040\043\026\162\015\201\044\036\016\320\036\243"
	"\364\125\121\303\270\012\252\244\023\070\370\004\341\122\126\323"
	"\145\365\314\026\071\317\005\076\072\143\155\212\375\320\125\034"
	"\367\323\116\061\371\051\226\041\275\376\341\042\241\253\314\342"
	"\004\271\375\241\337\324\313\071\270\326\376\077\220\314\273\364"
	"\300\371\005\345\100\154\241\367\036\352\330\240\102\141\364\015"
	"\306\122\173\033\272\155\165\213\230\155\355\326\352\355\050\110"
	"\031\067\263\257\120\075\207\210\215\000\354\007\103\122\375\045"
	"\063\311\273\075\030\125\040\136\211\274\133\356\277\212\135\366"
	"\353\155\243\063\225\261\115\064\164\146\202\070\122\227\040\273"
	"\251\331\135\361\337\076\217\116\222\225\276\323\310\253\275\347"
	"\251\156\077\141\154\006\204\346\223\127\235\002\120\015\020\277"
	"\002\076\366\261\150\374\145\264\320\026\325\165\353\077\007\127"
	"\112\251\035\330\263\165\064\144\235\265\277\130\160\137\045\155"
	"\024\071\077\257\313\315\177\314\073\361\345\361\212\155\075\214"
	"\362\365\064\046\130\236\227\321\215\365\141\234\166\276\263\356"
	"\245\240\066\375\077\215\037\024\314\204\106\071\152\134\246\233"
	"\040\100\215\071\255\255\076\326\231\064\016\231\233\073\031\213"
	"\133\354\156\330\066\312\226\214\027\211\136\026\167\256\002\074"
	"\003\145\175\121\151\155\236\140\170\240\002\156\344\203\375\170"
	"\253\147\217\303\114\241\153\323\325\174\327\252\347\275\221\120"
	"\065\327\347\036\061\010\353\041\347\164\256\125\222\070\135\046"
	"\365\102\151\123\271\142\016\150\174\251\310\203\054\212\210\310"
	"\302\137\053\277\223\237\374\221\032\123\152\063\222\136\025\242"
	"\142\233\323\027\031\241\040\350\163\336\263\274\302\301\221\250"
	"\064\311\031\227\300\104\074\265\022\336\143\110\221\363\067\023"
	"\247\033\332\007\317\157\002\120\245\351\100\342\363\024\232\043"
	"\317\162\250\177\133\077\332\011\112\010\103\371\052\241\234\357"
	"\050\055\204\013\155\327\176\350\337\311\344\031\246\251\301\270"
	"\261\342\127\120\377\040\271\034\312\236\216\250\074\346\024\126"
	"\144\055\312\337\021\212\321\247\306\060\374\325\272\252\336\116"
	"\363\361\172\110\155\274\152\126\252\044\366\147\144\232\342\354"
	"\224\264\105\046\177\232\173\124\114\227\307\263\077\044\232\277"
	"\155\025\265\037\061\217\102\033\032\204\201\326\177\372\213\133"
	"\242\102\361\102\333\240\274\163\316\251\033\220\022\343\120\222"
	"\167\073\023\253\311\207\271\375\153\123\244\350\223\235\173\163"
	"\106\117\252\001\307\114\031\143\103\011\330\164\372\242\163\373"
	"\241\012\225\205\212\000\140\115\271\323\034\145\070\326\053\367"
	"\216\232\055\101\105\226\051\046\114\014\066\013\227\015\037\044"
	"\123\072\315\233\336\303\004\336\076\116\264\044\254\332\130\162"
	"\143\131\125\171\015\061\164\077\302\370\217\373\250\117\102\101"
	"\014\241\377\034\105\165\040\236\347\352\244\311\144\277\125\050"
	"\107\070\040\335\312\121\245\255\040\042\255\144\021\351\161\225"
	"\170\205\041\174\010\107\332\135\001\170\267\234\045\060\363\312"
	"\001\125\004\234\056\030\055\046\044\047\310\101\110\270\065\045"
	"\165\057\163\216\372\352\357\307\075\122\172\347\030\152\204\342"
	"\153\167\305\247\254\333\262\216\100\355\112\165\226\144\006\051"
	"\107\146\150\257\164\105\205\063\267\225\075\340\166\054\311\377"
	"\371\100\165\065\302\032\164\257\031\301\204\042\171\211\325\222"
	"\232\000\076\072\007\354\202\164\155\052\071\252\102\221\225\301"
	"\305\234\353\364\076\330\237\332\276\370\176\164\145\365\362\050"
	"\223\043\220\347\171\374\121\322\373\051\142\335\211\211\207\274"
	"\275\236\261\154\206\160\362\000\001\033\235\342\374\231\011\251"
	"\057\273\212\353\112\224\066\244\364\152\160\353\107\215\350\355"
	"\030\352\145\021\336\112\212\060\351\323\153\072\202\266\200\333"
	"\224\361\337\164\256\023\017\200\126\374\346\216\014\017\247\011"
	"\143\017\317\326\162\076\375\330\343\134\115\341\263\025\200\357"
	"\123\160\173\135\250\066\046\253\072\026\257\114\263\341\223\146"
	"\015\156\055\025\176\355\274\155\362\154\056\212\330\104\111\245"
	"\113\163\242\345\075\332\141\123\211\262\043\175\164\250\001\033"
	"\366\237\031\231\154\154\242\305\105\140\334\176\364\211\150\057"
	"\227\231\342\363\043\162\200\066\060\376\062\005\222\115\016\277"
	"\222\363\017\353\272\352\264\040\276\212\031\234\207\203\345\151"
	"\327\103\257\271\215\025\135\372\214\207\157\023\006\213\156\322"
	"\173\236\334\325\232\076\355\312\313\365\131\023\355\135\062\311"
	"\022\274\065\372\352\367\026\235\210\304\264\045\343\167\376\155"
	"\203\077\165\011\142\073\266\335\075\004\177\377\074\012\120\251"
	"\330\111\237\376\265\343\340\247\366\234\020\216\311\312\116\177"
	"\261\144\332\076\330\166\373\006\067\310\317\000\220\053\203\046"
	"\127\173\216\260\256\262\002\366\202\145\162\151\062\176\170\363"
	"\211\140\170\144\227\345\317\166\206\121\306\127\251\324\345\257"
	"\042\364\121\375\342\220\107\224\107\046\300\315\143\237\262\237"
	"\046\232\275\352\331\254\112\310\215\223\037\260\112\150\046\223"
	"\153\310\252\375\317\142\051\157\303\265\053\213\135\302\311\016"
	"\145\071\127\124\211\147\110\116\301\201\344\037\301\325\167\336"
	"\046\317\070\040\035\226\227\343\356\053\172\311\241\254\272\212"
	"\312\354\076\230\062\232\152\316\333\340\211\356\375\320\176\315"
	"\165\063\310\347\057\141\116\011\046\320\364\305\147\167\202\323"
	"\316\134\371\135\257\300\043\210\310\252\067\367\071\275\040\030"
	"\052\331\004\110\206\032\134\365\236\023\155\332\277\003\156\112"
	"\362\156\215\063\027\300\102\111\035\234\072\354\142\112\007\157"
	"\045\220\164\122\332\061\360\242\207\040\045\344\020\320\226\050"
	"\125\272\203\350\122\162\044\160\016\330\134\054\257\167\311\173"
	"\147\346\127\141\001\201\066\132\132\133\156\253\311\061\337\046"
	"\317\361\121\300\156\272\101\006\116\162\355\331\023\032\002\312"
	"\337\277\006\204\076\277\027\026\152\102\277\213\140\233\017\044"
	"\205\217\045\117\272\354\171\271\374\026\255\312\172\123\304\255"
	"\003\306\070\364\151\174\263\304\042\226\070\015\126\224\050\355"
	"\330\016\214\012\106\311\231\130\325\061\367\266\335\316\360\102"
	"\114\177\107\125\074\362\066\275\324\366\017\246\355\237\364\337"
	"\043\011\151\155\316\002\054\344\173\341\023\240\343\317\072\223"
	"\376\344\361\202\166\364\301\351\302\155\243\066\367\226\054\164"
	"\256\166\013\013\277\105\274\100\004\003\256\272\076\047\150\022"
	"\136\351\336\145\041\041\107\220\303\356\220\227\062\107\066\032"
	"\326\076\171\333\120\377\057\246\277\237\264\271\372\225\152\272"
	"\111\342\271\232\344\375\114\132\367\377\136\143\271\136\334\151"
	"\356\052\025\170\301\302\267\215\214\263\106\053\064\276\351\323"
	"\354\254\345\327\334\112\224\267\262\055\044\124\370\342\035\240"
	"\203\307\100\063\246\154\311\065\312\047\052\377\130\064\105\067"
	"\353\233\217\327\130\310\235\136\235\136\313\170\203\360\074\157"
	"\001\034\131\124\135\210\033\142\250\125\340\353\036\372\063\163"
	"\371\171\171\344\147\322\241\151\126\022\073\234\311\011\273\232"
	"\036\367\217\034\155\067\100\262\131\314\006\202\237\226\131\153"
	"\223\001\254\221\073\132\332\212\275\017\131\365\036\047\275\107"
	"\171\240\266\323\115\070\005\301\134\323\103\306\044\273\354\206"
	"\240\043\225\123\253\262\177\251\020\116\143\214\334\066\312\061"
	"\344\155\221\203\022\200\127\014\372\101\015\155\101\164\220\062"
	"\036\105\341\127\346\223\023\006\231\131\144\220\207\012\255\130"
	"\172\346\067\145\104\200\334\313\215\133\214\302\017\022\323\104"
	"\070\303\142\143\031\214\336\237\170\343\305\026\370\030\324\175"
	"\141\162\333\010\131\201\026\315\153\006\243\065\112\145\254\122"
	"\154\363\344\016\365\004\021\324\134\235\316\335\375\241\226\211"
	"\016\176\172\077\067\071\211\236\355\305\105\206\074\135\167\030"
	"\071\031\367\127\171\236\373\055\064\326\253\045\156\177\071\265"
	"\272\350\271\100\116\007\116\237\312\206\311\244\156\224\316\154"
	"\145\204\004\347\033\021\103\207\071\311\055\232\203\177\016\244"
	"\077\334\320\117\015\225\160\026\151\052\014\216\171\007\315\141"
	"\234\014\175\213\131\063\363\145\154\327\315\004\041\333\033\142"
	"\112\000\221\075\063\005\301\371\142\071\331\306\346\323\065\304"
	"\224\026\157\235\117\167\314\120\243\016\125\071\176\157\256\237"
	"\316\051\356\130\031\233\067\347\351\104\335\201\211\251\130\014"
	"\010\017\104\036\103\146\355\212\151\123\275\346\255\071\200\245"
	"\331\363\003\177\370\020\022\142\323\150\050\022\060\317\342\154"
	"\241\261\345\043\035\150\114\261\341\250\111\076\336\005\154\360"
	"\336\341\223\113\106\161\076\327\116\323\276\140\241\046\011\250"
	"\007\112\314\044\262\030\325\224\301\037\322\237\044\077\217\002"
	"\041\043\116\147\225\215\077\343\141\375\104\002\044\115\252\053"
	"\227\167\117\112\220\045\336\121\104\261\361\151\361\201\153\022"
	"\245\272\172\072\107\271\035\250\267\142\253\333\257\126\007\107"
	"\315\126\221\135\174\160\257\300\041\240\051\022\042\225\045\307"
	"\117\237\002\227\130\037\100\020\201\353\354\061\101\363\171\017"
	"\112\012\154\306\172\034\206\234\275\257\256\337\105\323\247\224"
	"\163\251\054\313\311\154\334\113\127\310\174\231\273\365\250\005"
	"\000\025\313\173\061\122\027\357\002\306\316\107\232\166\334\015"
	"\037\010\331\351\165\265\064\315\176\261\146\071\247\017\076\250"
	"\044\012\043\126\134\073\105\136\002\024\245\235\212\202\253\252"
	"\212\204\223\000\072\310\315\271\171\063\362\041\102\061\311\147"
	"\074\355\275\230\051\002\367\053\027\235\311\241\037\164\114\252"
	"\371\340\252\064\250\167\355\042\253\340\103\355\021\015\125\115"
	"\373\022\346\044\025\335\120\054\173\031\316\232\216\033\105\207"
	"\373\357\273\243\147\251\306\022\211\012\000\233\027\125\350\023"
	"\150\317\067\175\255\207\252\050\241\171\303\057\224\011\266\217"
	"\371\162\063\140\034\371\163\245\004\164\100\034\312\051\057\062"
	"\371\146\260\246\356\132\317\217\324\222"
#define      tst2_z	19
#define      tst2	((&data[7212]))
	"\166\367\240\223\262\234\062\236\363\115\000\066\062\376\171\166"
	"\376\344\120\372\114\224\351\053"
#define      inlo_z	3
#define      inlo	((&data[7234]))
	"\246\032\361"
#define      lsto_z	1
#define      lsto	((&data[7237]))
	"\310"
#define      xecc_z	15
#define      xecc	((&data[7241]))
	"\247\025\165\153\343\110\351\077\213\101\326\326\211\147\073\262"
	"\242\041\331"
#define      chk1_z	22
#define      chk1	((&data[7262]))
	"\265\312\345\204\132\051\143\103\132\172\266\204\163\203\056\105"
	"\276\041\066\007\242\251\151\277\343\363\242\271\027\031"
#define      msg2_z	19
#define      msg2	((&data[7290]))
	"\031\107\170\142\347\322\331\006\277\070\257\350\146\221\002\045"
	"\143\267\142\036\100\122\104\075"
#define      rlax_z	1
#define      rlax	((&data[7311]))
	"\021"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
